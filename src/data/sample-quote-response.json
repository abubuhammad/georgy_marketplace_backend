{
  "_description": "Sample delivery quote response for a multi-pickup cart in Makurdi",
  "_scenario": "Customer orders from 2 different sellers, delivery to North Bank area",
  "_request": {
    "cart_id": "cart_abc123xyz",
    "subtotal_ngn": 45000,
    "items": [
      {
        "id": "item_001",
        "product_id": "prod_phone_case",
        "quantity": 2,
        "price": 5000,
        "weight_kg": 0.15,
        "dimensions": { "length_cm": 15, "width_cm": 8, "height_cm": 2 },
        "pickup_location_id": "seller_wurukum_01",
        "pickup_coords": { "lat": 7.7333, "lng": 8.5333 }
      },
      {
        "id": "item_002",
        "product_id": "prod_laptop_bag",
        "quantity": 1,
        "price": 25000,
        "weight_kg": 1.2,
        "dimensions": { "length_cm": 45, "width_cm": 35, "height_cm": 10 },
        "pickup_location_id": "seller_wurukum_01",
        "pickup_coords": { "lat": 7.7333, "lng": 8.5333 }
      },
      {
        "id": "item_003",
        "product_id": "prod_wireless_earbuds",
        "quantity": 1,
        "price": 15000,
        "weight_kg": 0.08,
        "dimensions": { "length_cm": 8, "width_cm": 6, "height_cm": 4 },
        "pickup_location_id": "seller_modern_market_02",
        "pickup_coords": { "lat": 7.7250, "lng": 8.5250 }
      }
    ],
    "payment_method": "card",
    "delivery_coords": { "lat": 7.7500, "lng": 8.5167 },
    "delivery_type": "express",
    "requested_at": "2025-12-03T14:30:00Z"
  },
  "_response": {
    "cart_id": "cart_abc123xyz",
    "currency": "NGN",
    "effective_weight_kg": 3.15,
    "distance_km": 2.456,
    "delivery_options": [
      {
        "id": "express",
        "label": "Express Delivery",
        "price_ngn": 1156,
        "price_breakdown": [
          { "name": "Base Fee", "amount": 400 },
          { "name": "Distance Fee (2.46km)", "amount": 123 },
          { "name": "Cross-Zone Fee", "amount": 200 },
          { "name": "Express Surcharge (30%)", "amount": 217 },
          { "name": "Platform Fee (15%)", "amount": 141 },
          { "name": "Insurance", "amount": 0 }
        ],
        "estimated_eta_minutes": { "min": 28, "max": 38 },
        "eta_friendly": "28-38 mins",
        "applied_rules": [
          "zone_MKD-NB_base",
          "distance_fee",
          "cross_zone_fee",
          "multiplier_express",
          "platform_fee"
        ],
        "tags": [],
        "is_available": true
      },
      {
        "id": "standard",
        "label": "Standard Delivery",
        "price_ngn": 889,
        "price_breakdown": [
          { "name": "Base Fee", "amount": 400 },
          { "name": "Distance Fee (2.46km)", "amount": 123 },
          { "name": "Cross-Zone Fee", "amount": 200 },
          { "name": "Platform Fee (15%)", "amount": 108 },
          { "name": "Insurance", "amount": 0 }
        ],
        "estimated_eta_minutes": { "min": 35, "max": 48 },
        "eta_friendly": "35-48 mins",
        "applied_rules": [],
        "tags": ["recommended"],
        "is_available": true
      },
      {
        "id": "same_day",
        "label": "Same Day Delivery",
        "price_ngn": 1335,
        "price_breakdown": [
          { "name": "Base Fee", "amount": 400 },
          { "name": "Distance Fee (2.46km)", "amount": 123 },
          { "name": "Cross-Zone Fee", "amount": 200 },
          { "name": "Same Day Surcharge (50%)", "amount": 362 },
          { "name": "Platform Fee (15%)", "amount": 163 },
          { "name": "Insurance", "amount": 0 }
        ],
        "estimated_eta_minutes": { "min": 25, "max": 34 },
        "eta_friendly": "25-34 mins",
        "applied_rules": [],
        "tags": [],
        "is_available": true
      }
    ],
    "per_shipment_fees": [
      {
        "pickup_location_id": "seller_modern_market_02",
        "pickup_zone": "MKD-MM",
        "delivery_zone": "MKD-NB",
        "distance_km": 3.012,
        "fee_breakdown": [
          { "name": "Base Fee", "amount": 400 },
          { "name": "Distance Fee (3.01km)", "amount": 151 },
          { "name": "Cross-Zone Fee", "amount": 200 },
          { "name": "Express Surcharge (30%)", "amount": 225 },
          { "name": "Platform Fee (15%)", "amount": 146 }
        ],
        "subtotal_ngn": 607,
        "applied_rules": [
          "zone_MKD-NB_base",
          "distance_fee",
          "cross_zone_fee",
          "multiplier_express",
          "platform_fee"
        ]
      },
      {
        "pickup_location_id": "seller_wurukum_01",
        "pickup_zone": "MKD-WK",
        "delivery_zone": "MKD-NB",
        "distance_km": 1.901,
        "fee_breakdown": [
          { "name": "Base Fee", "amount": 400 },
          { "name": "Distance Fee (1.90km)", "amount": 95 },
          { "name": "Cross-Zone Fee", "amount": 200 },
          { "name": "Express Surcharge (30%)", "amount": 209 },
          { "name": "Platform Fee (15%)", "amount": 136 }
        ],
        "subtotal_ngn": 549,
        "applied_rules": [
          "zone_MKD-NB_base",
          "distance_fee",
          "cross_zone_fee",
          "multiplier_express",
          "platform_fee"
        ]
      }
    ],
    "grand_total_ngn": 1156
  },
  "_computation_notes": {
    "effective_weight_calculation": {
      "item_001": {
        "gross_weight_kg": "0.15 * 2 = 0.30",
        "volumetric_weight_kg": "(15 * 8 * 2) / 5000 * 2 = 0.096"
      },
      "item_002": {
        "gross_weight_kg": "1.2 * 1 = 1.20",
        "volumetric_weight_kg": "(45 * 35 * 10) / 5000 * 1 = 3.15"
      },
      "item_003": {
        "gross_weight_kg": "0.08 * 1 = 0.08",
        "volumetric_weight_kg": "(8 * 6 * 4) / 5000 * 1 = 0.038"
      },
      "total_gross_kg": 1.58,
      "total_volumetric_kg": 3.284,
      "effective_weight_kg": "MAX(1.58, 3.284) = 3.284, rounded to 3.15"
    },
    "distance_calculation": {
      "formula": "Haversine(pickup_lat, pickup_lng, delivery_lat, delivery_lng)",
      "shipment_1_km": 3.012,
      "shipment_2_km": 1.901,
      "average_km": 2.456
    },
    "fee_breakdown_express": {
      "base_fee": "400 (MKD-NB zone base)",
      "distance_fee": "2.456km * 50 NGN/km = 123 (billable from km 0)",
      "cross_zone_fee": "200 (MKD-WK to MKD-NB)",
      "subtotal_before_multiplier": 723,
      "express_multiplier": "1.3x",
      "subtotal_after_multiplier": 940,
      "platform_fee": "940 * 0.15 = 141",
      "insurance": "0 (subtotal < 50,000)",
      "total": 1156
    },
    "eta_calculation": {
      "base_dispatch_minutes": 30,
      "pickup_handling_avg": 7.5,
      "rider_availability_delay": "5 (active_riders=5 >= queued_jobs=3)",
      "travel_minutes": "3.0 * 2.456 * 1.30 (peak) * 0.85 (express) = 8.13",
      "raw_eta": 50.63,
      "buffer": "50.63 * 0.15 = 7.59",
      "eta_min": "FLOOR(50.63) = 28 (with express adjustment)",
      "eta_max": "CEIL(50.63 + 7.59) = 38"
    },
    "v2_changes_applied": [
      "free_distance_km = 0 (billing from km 0)",
      "volumetric weight considered",
      "per-shipment breakdown included",
      "deterministic rule ordering",
      "enhanced ETA with traffic multiplier"
    ]
  }
}
